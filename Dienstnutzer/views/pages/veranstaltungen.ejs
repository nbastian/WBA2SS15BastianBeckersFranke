<!DOCTYPE html>
<html lang="en">
<head>
    <% include ../partials/head %>
</head>
<body class="container">

    <header>
        <% include ../partials/header %>
    </header>

    <main>
        <div class="row">
            <div class="col-sm-12">
                <ul class="list-group">
                    <% veranstaltungen.forEach(function(event) { %>
                    <a href="/veranstaltungen/<%= event.id %>" class="list-group-item">
                        <h4 class="list-group-item-heading"><%= event.name %></h4>
                        <p class="list-group-item-text">Start:<%= event.dateStart %></p>
                        <p class="list-group-item-text">Ende:<%= event.dateEnd %></p>
                    </a>
                    <% }); %>
                </ul>
            </div>
            <div class="col-sm-12">
                <form id="newEventForm" action="/" method="post">
                    <label for="inputEventname" class="sr-only">Veranstaltungsname</label>
                    <input name="name" type="text" id="inputEventname" class="form-control" placeholder="Veranstaltungsname" required>
                    <label for="inputDateStart" class="sr-only">Startdatum</label>
                    <input name="dateStart" type="datetime" id="inputStartDate" class="form-control" placeholder="Startdatum" required>
                    <label for="inputDateEnd" class="sr-only">Enddatum</label>
                    <input name="dateEnd" type="datetime" id="inputEndDate" class="form-control" placeholder="Enddatum" required>
                    <button class="btn btn-lg btn-primary btn-block" type="submit">Sign in</button>
                </form>
                <script type="text/javascript">
                $(document).ready(function(){
                    $('#newEventForm').submit(function(e) {
                        var postData = $(this).serialize();
                        var formURL = '//localhost:1338/veranstaltungen';
                        $.ajax (
                            {
                                url: formURL,
                                type:"POST",
                                data: postData,
                                success: function(data)
                                {
                                    console.log('geht');
                                },
                                error: function()
                                {
                                    console.log('geht nicht');
                                }
                            });
                        e.preventDefault();
                        //e.unbind();
                    });
                    $('#newEventForm').submit();
                })
                </script>
            </div>
        </div>
    </main>

    <footer>
        <% include ../partials/footer %>
    </footer>
    
</body>
</html>